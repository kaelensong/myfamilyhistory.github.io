<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="reset.css"> 
    <link rel="stylesheet" href="styles.css"> 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Fredoka:wght@300..700&family=Lora:ital,wght@0,400..700;1,400..700&family=Outfit:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Fredoka:wght@300..700&family=Lora:ital,wght@0,400..700;1,400..700&family=Outfit:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Fredoka:wght@300..700&family=Libre+Bodoni:ital,wght@0,400..700;1,400..700&family=Lora:ital,wght@0,400..700;1,400..700&family=Outfit:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Infant:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Josefin+Sans:ital,wght@0,100..700;1,100..700&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Sulphur+Point:wght@300;400;700&family=Taviraj:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
</head>
<body onload="showMessage()"> 
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <div id='image'></div>
        <a href="index.html" id="homeButton">Back to Home</a>
 
        <div class="messageContainer">
            <div id="openingMessage">
                <p>Click on a hotspot to begin</p>
             </div>
        </div> 

        <button id="contButton">Continue</button>
        <button id="backButton">Previous</button>
    
    <div class="container">
        <img class="koreaGIF" src="">
        <!-- Hidden popup divs for each hotspot -->
        <div class="popup" id="popup_Pyongyang">
            <div class="pu profilePics">
                <img src="images/joseph1.png" alt="photograph of Joseph Song">
            </div>
            <div class="pu headings1">
                <h3>Birthplace of Joseph Song</h3>
            </div>
            <div class="pu subheadings1">
                <h2>Hwanghae-do, Pyongyang, North Korea: 1922-1944</h2>
            </div>
            
            <div class="pu para top leftTextA">
                <p>The true date of my grandfather, Joseph's birthday is not known.
                    Some say he was born in 1922 and others say it was 1926. All we know for sure is that we celebrate his birthday every year on December 26th. </p>
                </div>
            <div class="pu para middle rightTextA">
                <p>He was born the oldest of 3 brothers in a family of wealthy, Christian farmers 
                    residing in Hwanghae-do, Pyongyang in what is now North Korea. When Joseph was 13 years old, his father died of 
                    appendicitis and he assumed the responsibility of being the man of the household.
                </p>
            </div>
            <div class="pu para bottom leftTextA">
                <p>Around 1944, when the communists began to advance, Joseph was at work 
                    as a teacher at the local school. Without any notice, Joseph's cousin and middle brother came to his 
                    workplace in a stolen ambulance and told Joseph that they needed to leave immediately. The brothers 
                    quickly stowed away in the back of the ambulance and fled their hometown forced to leave the rest of their family behind,
                    not knowing if they were okay or if they would ever see them again. 
                    My grandfather was around 18 years of age at the time and had a wife and three children. 
                </p>
            </div>
            <div class="pu centeredImage">
                <img class="imgs" src="images/kidsPyongyang1930.jpeg" alt="Children playing in Pyongyang area, around 1930. Source: Photo Book of Pyongyang Diocese">
            </div>
        </div>

        <div id="popup_Seoul" class="popup">
            <img class="pu profilePics" src="images/youngja1.png" alt="">
            <div class="pu headings1">
                <h3>Birthplace of Young-Ja Song</h3>
            </div>
            <div class="pu subheadings1">
                <h2>Gyeongbokgung, Seoul, South Korea: 1940-1945</h2>
            </div>

            <div class="pu para top rightTextB">
                <p> My grandmother, Young-Ja, was born February 20th, 1940 in Seoul, South Korea. 
                    As a child she recalls being comfortable and happy, living in a three-bedroom 
                    house with her father, her mother, and two older brothers. Her father was a successful 
                    businessman, managing a soy sauce company, so they had plenty to eat, and even enough to 
                    share with the community. At a time when the country was poor, she remembers her father 
                    constantly taking people in and sharing what they had.
                </p>
            </div>

            <div class="pu top leftImage">
                <img class="imgs" src="images/seoul1940.jpg" alt="https://www.flickr.com/photos/dok1/106518783">
            </div>
            
        </div> 

        <div id="popup_Busan" class="popup">
            <div class="pu headings">
                <h3>The Flight South</h3>
            </div>
            <div class="pu subheadings">
                <h2>Busan, South Korea: 1945</h2>
            </div>
            <div class="pu para middle leftTextB">
                <p>Once the Korean War started, almost everyone fled South towards Busan, away from the fighting,
                     including my grandmother and grandfather.
                </p>
            </div>
            <div class="pu para bottom rightTextB">
                <p>
                     While en route, Young-Ja and her middle brother got separated from their parents. 
                     The siblings then got jobs, her as a housekeeper and him as a bell boy. 
                     They survived on burnt rice scraps, also referred to as nurungji, and other discarded food, 
                     hiding the bits of food in her clothes to eat later.
                </p>
            </div>
            <div class="pu middle rightImage">
                <img class="imgs" src="images/ship.jpg" alt="">
            </div>
            <div class="pu bottom leftImage">
                <img class="imgs" src="images/refugee.jpg" alt="">
            </div>
        </div>

        <div id="popup_postWar" class="popup">
            <div class="pu headings">
                <h3>After the War: Rebuilding and Grieving</h3>
            </div>
            <div class="pu subheadings">
                <h2>Seoul, South Korea: 1954-1971</h2>
            </div>

            <div class="pu para top rightTextB">
                <p>One year after the war, Young-Ja returned to her home address, looking for her family. It was there that they 
                    reunited after around four years apart. Joseph was reunited with his eldest son, but never received any 
                    news on his wife and other two children.</p>
            </div>
            <div class="pu para middle leftTextB">
                <p>Following the Korean War, like millions of others, my grandparents had lost all semblance of normality 
                    and were forced to start almost completely over. Both Christians, they found work through their faith; 
                    Young-Ja, as a Catholic Sunday school teacher, and Joseph, as a Presbyterian minister in Seoul, South Korea. 
                    Joseph's son, Daniel, was Young-Ja's student and adored her so much that he introduced them. 
                    They got married a few years later and began their life together.</p>
            </div>
            <div class="pu para bottom rightTextB">
                    <p>Young-Ja and Joseph had three sons, ranging from oldest to youngest: John, Charles (or Charlie), and Samuel II (or Sam). </p>
            </div>
            <div class="pu top leftImage">
                <img class="imgs" src="images/famPic2.jpeg" alt="">
            </div>
            <div class="pu middle rightImage">
                <img class="imgs" src="images/charJohn.jpeg" alt="">
            </div>
            <div class="pu bottom leftImage">
                <img class="imgs" src="images/bikes1.JPEG" alt="">
            </div>
        </div>

        <div id="popup_CA" class="popup">
            <div class="pu headings">
                <h3>Off to California!</h3>
            </div>
            <div class="pu subheadings">
                <h2>From Seoul to California: 1970-1971</h2>
            </div>
            <div class="pu para top rightTextB">
                <p>Joseph went a year earlier to California to set things up for the family. That meant that Young-Ja had to 
                    fly with three boys under the age of 5! The entire plane ride they were crawling under the seats and 
                    other passengers had to tell her where they were. And when they got to
                    customs all three boys ran away once again and she had to call over the intercom for them.
                </p>
            </div>
            <div class="pu top leftImage">
                <img class="imgs" src="images/bikes2.JPEG" alt="">
            </div>
            <div class="pu middle rightImage">
                <img class="imgs" src="images/bikes3.JPEG" alt="">
            </div>
        </div>

        <div id="popup_Anaheim" class="popup">
            <h3 id="anaheimh3" class="headings">Welcome to America.</h3>
            <p id="comingSoon">More to come soon!</p>
            <img src="" alt="">
        </div>

        <div id="airplane">
            <audio id="planeAudio">
                <source src="sounds/plane-takeoffTrim.mp3" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </div>
    </div>

    <script>
        //show opening message
        var showMessage = function() {
            $('#openingMessage').fadeIn(function () {
                $(this).delay(4000).fadeOut().css('opacity', '0');
            }).css('opacity', '100');
        }
        var slides = ['Pyongyang', 'Seoul', 'Busan', 'postWar', 'CA', 'Anaheim', 'EXIT', 'DowntownA', 
                        'EastA'];
        var slideIndex = 0;
        var imageWidth = 1280;
        var imageHeight = 1100;
        var aspectRatio = imageWidth / imageHeight;
        var zoomed = false;
        var firstClicked = "";
        var hotspotId = "";
        var Hx, Hy = 0; // used to zoom in on hotspots and zoom back out 
                        // when background changes to Anaheim
        var hotspots = [{
                id: 'Pyongyang',
                x: 570,
                y: 440,
                height: 40,
                width: 40,
                numClicks: 0
            }, { 
                id: 'Seoul',
                x: 610,
                y: 510,
                height: 40,
                width: 40,
                numClicks: 0
            }
        ];
        $(window).resize(function() {
            positionHotSpots();
        });
        var positionHotSpots = function() {
            $('.hotspot').remove();
            var wi = 0,
                hi = 0;
            var r = $('#image').width() / $('#image').height();
            if (aspectRatio <= r) {
                wi = $('#image').width();
                hi = $('#image').width() / aspectRatio;
            } else {
                wi = $('#image').height() * aspectRatio;
                hi = $('#image').height();
            }
            var offsetTop = (hi - $('#image').height()) / 2;
            var offsetLeft = (wi - $('#image').width()) / 2;
            $.each(hotspots, function(i, h) {

                var x = (wi * h.x) / imageWidth;
                var y = (hi * h.y) / imageHeight;

                var ww = (wi * (h.width)) / imageWidth;
                var hh = (hi * (h.height)) / imageHeight;

                var hotspot = $('<div>').attr('id', h.id).addClass('hotspot').css({
                    top: y - offsetTop,
                    left: x - offsetLeft,
                    height: hh,
                    width: ww
                });
                $('body').append(hotspot);
            });
            // CLICKING ON HOTSPOTS AND ZOOMING IN
            $('.hotspot').click(function() {
                $('.hotspot').remove();
                $('#image').css({"opacity": "0"}); 
                hotspots = [{id: 'Pyongyang', height: 0, width: 0}, 
                            {id: 'Seoul', height: 0, width: 0}];
                hotspotId = $(this).attr('id');
                if (firstClicked === "") {
                    firstClicked = hotspotId; // Store the ID of the first clicked hotspot
                    console.log("First hotspot clicked: " + firstClicked);
                }
                var clickedHotspot = hotspots.find(function(hotspot) {
                    return hotspot.id === hotspotId;
                });
                slideIndex = slides.indexOf(hotspotId); // get & store curr slide index 
                console.log(slideIndex);
                $('.popup').hide(); //close curr popup
                $('#contButton').show(); // show the continue button
                showSlide('popup_' + hotspotId);
                clickedHotspot.numClicks++; // increment num clicks
                console.log(hotspotId + " has been clicked " + clickedHotspot.numClicks + " times.")
            });
        };

        positionHotSpots();

        // Fade in and out
        function showSlide(slideId) {
            //Hide opening message
            $('#openingMessage').fadeOut().css('opacity', '0');
            //Fade in popup
            document.getElementById(slideId).style.display = "grid";
            $('#' + slideId).fadeIn().css('opacity', '100');
            $('#' + slideId).addClass('visible');
            $('.container').css({"background": "url(images/bg_" + slideId +".jpg)"})
            $('.koreaGIF').attr('src', 'images/'+ slideId +'.gif');
            if(slideIndex > 0) {
                $('#backButton').show(); // show the previous button
            } else {
                $('#backButton').hide();
            }
        }

        $('#contButton').click(function() {
            $('.popup').hide(); // Hide current popup
            slideIndex = getNextSlideIndex(slideIndex);
            if(slides[slideIndex] == 'CA'){
                animate2CA();
            } else if (slides[slideIndex] == 'EXIT') {
                 window.location.href = "index.html";
            }
            showSlide('popup_' + slides[slideIndex]);
        });

        $('#backButton').click(function() {
            if (slideIndex > 0) { // prevent going before the first slide
                $('.popup').hide(); // Hide current popup
                slideIndex = getPrevSlideIndex(slideIndex);
                showSlide('popup_' + slides[slideIndex]);
            }
        });

        // Helper function to determine the next slide based on the current slide index
        function getPrevSlideIndex(currentIndex) {
            if (slides[currentIndex] === 'Seoul' && firstClicked === 'Seoul') {
                return slides.indexOf('Pyongyang');
            }
            return currentIndex - 1;
        }

        // Helper function to determine the next slide based on the current slide index
        function getNextSlideIndex(currentIndex) {
            if (slides[currentIndex] === 'Seoul' && firstClicked === 'Seoul') {
                return slides.indexOf('Pyongyang'); //If Pyongyang hasn't been shown yet
            } else if (slides[currentIndex] === 'Pyongyang'  && firstClicked === 'Seoul') { 
                //If Seoul has already been shown
                return currentIndex + 2;
            }
            return currentIndex + 1; // Default case for normal sequence
        }

    var animate2CA = function() {
        document.getElementById("planeAudio").play(); //play sound

        //animate airplane
        $('#airplane').show();
        $('#airplane').css('transition', 'transform 15s ease-in-out');
        var viewportWidth = $(window).width();
        var viewportHeight = $(window).height();
        $('#airplane').css('transform', 'translateX(' + (viewportWidth / 1.3) + 'px) translateY(' + (viewportHeight * .07) + 'px)');      
        //fshow hotspot after animation is finished
            setTimeout(function() {
                console.log("IN SET TIMEOUT");
                $('.hotspot').show();
                // Move the hotspots to their Anaheim position
                $('.hotspot').each(function() {
                    $(this).css({
                        left: 1160,
                        top: 335
                    });
                });
                $('#airplane').hide();
            }, 14950); 
       
    };

        //Moving to california changes the backgound image
        var anaheim = function() {
            // Set new background image
            var imgURL = "images/CA_Anaheim_287970_1965_24000_geo.jpg";
            // reset background scale and background align
            $('#image').css({
                "background-image": "url(" + imgURL +")",
                "background-position": "right",
                'transform': 'scale(1)' 
            });           
        };

        // change existing hostposts and create new hotspots 
        // 4 in total
        var anaheimHotspots = function(){
            // remove existing hotspots
            hotspots = [];

            var clickedHotspot = hotspots.find(function(hotspot) {
                        return hotspot.id === 'DTAnaheim';
                });

            // Define new hotspots for Anaheim scene
            hotspots.push({
                id: 'DTAnaheim',
                x: 1250,
                y: 300,
                height: 50,
                width: 50,
                numClicks: 0
            });
            hotspots.push({
                id: 'Church',
                x: 935,
                y: 495,
                height: 50,
                width: 50,
                numClicks: 0
            });
            hotspots.push({
                id: 'EastAnaheim',
                x: 940,
                y: 570,
                height: 50,
                width: 50,
                numClicks: 0
            });
            hotspots.push({
                id: 'Katella',
                x: 1755,
                y: 323,
                height: 50,
                width: 50,
                numClicks: 0
            });

            // Position hotspots on bg image
            positionHotSpots();
        }
    </script>
</body>
</html>
